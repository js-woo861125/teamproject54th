<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="~{admin/layout/default}">
	<!-- head 삽입공간 -->
	<head>
	</head>
	
	<th:block layout:fragment="jsScript">
		<script>
			/**
			* 품목명 + 카테고리 중복체크
			*/
			$('#addItemBtn').click(function(){
				const itemName = $('#itemName').val();
				const categoryNo = $('#categoryNo').val();
				
				if(!itemName){
					alert('품목명을 입력해주세요');
					$('#itemName').focus();
					return ;
				}
				
				if (!categoryNo) {
					alert('카테고리를 선택해주세요');
					$('#categoryNo').focus();
					return;
				}
				
				$.ajax({
					url : '/admin/productInfo/itemNameCheck',
					method : 'post',
					data : {
						'itemName': itemName,
						'categoryNo' : categoryNo	
					},
					dataType : 'json'
				}).done(function(isDuplicate) {
					if(isDuplicate){
						alert('이미 등록된 품목명 입니다.');
						$('#itemName').focus();
						return ;
					}
				
					$('#addProductInfoForm').submit();
			    }).fail(function(jqXHR, textStatus, error) {
			        console.log("에러 발생:", textStatus, error);
			        alert('품목명 확인 중 오류가 발생했습니다.');
			    });
			});
		</script>
	</th:block>
	
	<!-- 페이지 삽입공간 -->
	<th:block layout:fragment="content">
		<div class="content-header">
			<div>
				<h2 class="content-title card-title" th:text="${title}"></h2>
			</div>
		</div>
		<div class="card mb-4 col-8">
			<div class="card-body">
				<div class="col-12">
					<div class="row gx-5">
						<aside class="col-lg-3 border-end">
							<nav class="nav nav-pills flex-column mb-4">
								<a class="nav-link" th:href="@{/admin/productInfo/addCategory}">카테고리</a>
								<a class="nav-link" th:href="@{/admin/productInfo/addBrand}">브랜드</a>
								<a class="nav-link active" aria-current="page" th:href="@{/admin/productInfo/addItem}">품목</a> 
								<a class="nav-link" th:href="@{/admin/productInfo/addModel}">모델</a>
								<a class="nav-link" th:href="@{/admin/productInfo/addBenefit}">전체혜택</a>
								<a class="nav-link" th:href="@{/admin/productInfo/addCategorySpec}">카테고리별/상세스펙</a> 
								<a class="nav-link" th:href="@{/admin/productInfo/addModelSpec}">모델별/상세스펙</a>
							</nav>
						</aside>
						<div class="col-lg-9">
							<form id="addProductInfoForm" th:action="@{/admin/productInfo/addItem}" method="post">
								<section class="content-body p-xl-4">
									<div class="col-12">
										<div class="mb-4">
											<label class="form-label fs-6" for="managerId">관리자아이디</label>
											<div class="col-lg-12">
												<input type="text" id="managerId" name="managerId" class="form-control" placeholder="아이디를 입력해주세요" />
											</div>
										</div>
										<div class="mb-4">
											<label class="form-label fs-6" for="categoryNo">카테고리</label> 
											<select class="form-select text-center fs-7" id="categoryNo" name="categoryNo">
												<option value="">카테고리를 선택해주세요</option>
												<th:block th:if="${not #lists.isEmpty(categoryList)}"
													th:each="l : ${categoryList}">
													<option th:value="${l.categoryNo}" th:text="${l.smCategory}"></option>
												</th:block>
											</select>
										</div>
										<div class="mb-4">
											<label class="form-label fs-6" for="itemName">품목명</label>
											<div class="col-lg-12">
												<input type="text" id="itemName" name="itemName"
													class="form-control" placeholder="품목명을 입력해주세요" />
											</div>
											<!-- col.// -->
										</div>
									</div>
									<br />
									<!-- 버튼 -->
									<div class="d-grid gap-2 d-md-flex justify-content-md-end">
										<div class="col-md-2 col-2 ms-auto">
											<button type="button" id="addItemBtn" 
													class="btn btn-success w-100 rounded font-lg hover-up text-white justify-content-center fs-6">등록</button>
										</div>
										<div class="col-md-2 col-2">
											<button type="reset" onclick="location.href='/admin/productInfo/itemList'" 
													class="btn btn-warning w-100 rounded font-lg hover-up text-white justify-content-center fs-6">등록취소</button>
										</div>
									</div>
								</section>
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>
	</th:block>

</html>
